# 20377199 赵芮箐 第3周作业

![image-20220920100217698](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220920100217698.png)

> 注意：如果规模太大处理不了，可以酌情处理一部分。

### 任务一：数据清洗

###### 1. 实现一个函数，对微博数据进行清洗，去除噪声（如url等），过滤停用词。注意分词的时候应该将情绪词典加入Jieba或pyltp的自定义词典，以提高这些情绪词的识别能力。

![image-20220923200214748](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220923200214748.png)

![image-20220925153737098](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925153737098.png)

![image-20220925232057559](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925232057559.png)

**部分结果展示：**

![image-20220925094339821](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925094339821.png)

去除了@的用户对象、url等，把表情保留了，因为表情很多都含有情绪，也在情绪词典中

### 任务二：情绪分析

###### 2. 实现两个函数，实现一条微博的情绪分析，返其情绪向量或情绪值。目前有两种方法，一是认为一条微博的情绪是混合的，即一共有n个情绪词，如果joy有n_1个，则joy的比例是n_1/n；二是认为一条微博的情绪是唯一的，即n个情绪词里，anger的情绪词最多，则该微博的情绪应该为angry。

>注意，这里要求用闭包实现，尤其是要利用闭包实现一次加载情绪词典且局部变量持久化的特点。同时，也要注意考虑一些特别的情况，如无情绪词出现，不同情绪的情绪词出现数目一样等，并予以处理（如定义为无情绪，便于在后面的分析中去除）。

- 法一：认为一条微博的情绪是混合的，即一共有n个情绪词，如果joy有n_1个，则joy的比例是n_1/n

  ![image-20220925092957875](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925092957875.png)

  **部分结果示例：**

  ![image-20220925094713203](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925094713203.png)

  最后一句全文是：`不行了≪爸爸去哪儿≫这节目看不下去了。。。超想生孩子。我先歪沙发里假装睡着了听一耳朵吧[抓狂]好喜欢王诗龄和kimi`

  打印了看了一下都是什么词汇影响的情绪：

  ![image-20220925102436494](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925102436494.png)

  震惊，居然是这些词汇！"不行"居然是sadness而不是anger，从这就感觉不是很好用了。

- 法二：认为一条微博的情绪是唯一的，即n个情绪词里，anger的情绪词最多，则该微博的情绪应该为angry

  ![image-20220925104648685](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925104648685.png)

  **部分结果示例：**

  ![image-20220925104513586](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925104513586.png)

  情绪跟上文就是对应的！是情绪词最多对应的情绪！

###### 5. （附加）讨论字典方法进行情绪理解的优缺点，有无可能进一步扩充字典来提高情绪识别的准确率？如何扩充，有无自动或半自动的扩充思路？

- 字典方法情绪理解的优缺点

  优点：方法比较简单易操作

  缺点：准确性很不高啊，纯评词语来判断情绪若遇到复杂的句式或者隐晦的情绪表达，很容易判断错误。

- 有无可能进一步扩充字典来提高情绪识别的准确率
  
  肯定会好很多，考虑更多可能性。但毕竟语言的文学性变化太复杂，只一味的扩充字典的话，提高的效果甚微，准确率应该还是很低
  
- 扩充的办法
  
  会有半自动的方法，首先构建基础的情绪种子词，再用SO_PMI算法用语料库去训练它，即可帮我们扩充情绪字典，已经有很多人做这个项目了：https://blog.csdn.net/weixin_38008864/article/details/105172102

### 任务三：时空分析

###### 3. 微博中包含时间，可以讨论不同时间情绪比例的变化趋势，实现一个函数，可以通过参数来控制并返回对应情绪的时间模式，如joy的小时模式，sadness的周模式等。

![image-20220925155643592](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220925155643592.png)

![image-20220926002009187](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926002009187.png)

![image-20220926002027560](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926002027560.png)

![image-20220926002043564](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926002043564.png)

###### 4. 微博中包含空间，可以讨论情绪的空间分布，实现一个函数，可以通过参数来控制并返回对应情绪的空间分布，即围绕某个中心点，随着半径增加该情绪所占比例的变化，中心点可默认值可以是城市的中心位置。

![image-20220926003150022](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926003150022.png)

![image-20220926002120119](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926002120119.png)

**结果展示：**

![image-20220926011012389](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926011012389.png)

挺惊喜的发现当距离越远的时候，占比越趋于稳定，且趋于0.5（5个情绪中只有joy一个正面情绪，故占0.5）

###### 6. （附加）可否对情绪的时间和空间分布进行可视化？（如通过matplotlib绘制曲线，或者用pyecharts（注意版本的兼容性）在地图上标注不同的情绪）

- joy的小时分析

  ![image-20220926004420403](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926004420403.png)

  果然，现在网友都是到晚上上线娱乐，开心的情绪从5点（下班时间）开始晚上持续走高，零点达到峰值，然后下降。（睡觉的点+emo时刻到，不过冲浪的果然都是熬夜人)

- sadness的周分析

  ![image-20220926005745360](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926005745360.png)

  大家原来周四最不悲伤吗！！！因为疯狂星期四吗哈哈哈哈哈

  周日和周一的悲伤情绪达到了极高点，果然是要上学/上班了，所以都要悲伤很多

- joy以北京为中心的空间分布

  ![image-20220926013258519](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926013258519.png)
  
  ![image-20220926013517838](C:\Users\DELL\AppData\Roaming\Typora\typora-user-images\image-20220926013517838.png)
  
  原来，数据就是取了这么一个方框！

###### 7. （附加）思考情绪时空模式的管理意义，如营销等。

- 政府管理角度：
  对舆论控制管理很有帮助，能够快速判断和分析社会热点话题的爆发、传播的趋势，有助于分析其中可能存在的造谣带节奏等潜在风险隐患。
- 营销策略角度：
  对于精准投放广告等营销策略很有帮助，比如在joy时间峰值投放相关产品广告、开直播等，有助于销售。

### 代码：

https://github.com/rachhhhing/mp2022_python/blob/master/week3.py

### Ref：

- 微博数据清洗：https://github.com/blmoistawinde/HarvestText

- 正则表达式：https://blog.csdn.net/jackandsnow/article/details/103885422

- Dataframe：https://www.runoob.com/pandas/pandas-dataframe.html

- matplotlib：https://blog.csdn.net/sinat_36219858/article/details/79800460

- pyecharts：https://blog.csdn.net/weixin_43746433/article/details/91346371